"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9001],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>u});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),f=c(n),u=o,k=f["".concat(l,".").concat(u)]||f[u]||s[u]||a;return n?r.createElement(k,i(i({ref:t},d),{},{components:n})):r.createElement(k,i({ref:t},d))}));function u(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=f;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:o,i[1]=p;for(var c=2;c<a;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},2633:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>s,frontMatter:()=>a,metadata:()=>p,toc:()=>c});var r=n(7462),o=(n(7294),n(3905));const a={sidebar_label:"USB Networking Setup",sidebar_position:10},i="USB Networking",p={unversionedId:"rock5/configuration/usbnet",id:"rock5/configuration/usbnet",title:"USB Networking",description:"Most of radxa products have reserved a USB port as an OTG port, it also a adb debug port when runuing Android.You can consult the port definitions of the corresponding products.",source:"@site/docs/rock5/configuration/usbnet.md",sourceDirName:"rock5/configuration",slug:"/rock5/configuration/usbnet",permalink:"/zh/rock5/configuration/usbnet",draft:!1,editUrl:"https://github.com/radxa-docs/documentation/edit/main/docs/rock5/configuration/usbnet.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_label:"USB Networking Setup",sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"rsetup Tool Introduction",permalink:"/zh/rock5/configuration/rsetup-tool"},next:{title:"Application Development",permalink:"/zh/rock5/app-dev"}},l={},c=[{value:"Preparations",id:"preparations",level:2},{value:"OTG Settings",id:"otg-settings",level:2},{value:"To the Host machine",id:"to-the-host-machine",level:3},{value:"To Device machine",id:"to-device-machine",level:3}],d={toc:c};function s(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"usb-networking"},"USB Networking"),(0,o.kt)("p",null,"Most of radxa products have reserved a USB port as an OTG port, it also a adb debug port when runuing Android.You can consult the port definitions of the corresponding ",(0,o.kt)("a",{parentName:"p",href:"https://radxa.com/product"},"products"),".",(0,o.kt)("br",{parentName:"p"}),"\n","For ROCK 5A, it's the USB 3.0 port located above.",(0,o.kt)("br",{parentName:"p"}),"\n","You can set up a shared network between two products by connecting their OTG ports. Now officially supported for latest linux and android images only.  "),(0,o.kt)("h2",{id:"preparations"},"Preparations"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Cable"),": Before you start, you will need one USB-A to USB-A cable to connect two SBCs.  "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Software"),": If your SBC has not the latest software, connect you SBC to internet and type the following command:  "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"radxa@rock-5a:~$ sudo apt update && apt upgrade\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Service"),": After updating software, you need to start the ",(0,o.kt)("inlineCode",{parentName:"p"},"radxa-usbnet")," service:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo systemctl enable --now radxa-usbnet\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Status"),": Typing the command to confirm if the service is running:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo systemctl status radxa-usbnet.service\n")),(0,o.kt)("p",null,"The service active status is usually ",(0,o.kt)("inlineCode",{parentName:"p"},"active(exited)")," when running.  "),(0,o.kt)("h2",{id:"otg-settings"},"OTG Settings"),(0,o.kt)("p",null,"At first, connect the two SBC OTG ports by USB-A to USB-A cable.",(0,o.kt)("br",{parentName:"p"}),"\n","Device identity of this shared network depends on what ",(0,o.kt)("a",{parentName:"p",href:"../configuration/devicetree"},"overlay")," you enable,the host machine shares the network to device mahine.",(0,o.kt)("br",{parentName:"p"}),"\n","The host machine enable this overlay:  "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"        [*] Set OTG port to Host mode \n")),(0,o.kt)("p",null,"The device machine enable this overlay:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"        [*] Set OTG port to Peripheral mode \n")),(0,o.kt)("p",null,"Don't forget to reboot after enable options.  "),(0,o.kt)("h3",{id:"to-the-host-machine"},"To the Host machine"),(0,o.kt)("p",null,"For sharing the network to device machine, host machine need to connect to the external network, both wired and wireless networks are available.",(0,o.kt)("br",{parentName:"p"}),"\n","Next, we need to set up a shared adapter for the device machine connection, which can be set on the KDE Desktop and Terminal.",(0,o.kt)("br",{parentName:"p"}),"\n","This guide you set it on terminal:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Set shared adapter:"),"  "),(0,o.kt)("p",null,"Before operating, comfirm if there is a new networkcard device: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"radxa@rock-5a:~$ ip a\n")),(0,o.kt)("p",null,"The name of it may be different:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"3: enxca5bfb533dd4: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether ca:5b:fb:53:3d:d4 brd ff:ff:ff:ff:ff:ff\n    inet6 fe80::b989:8daf:feb5:f020/64 scope link noprefixroute\n       valid_lft forever preferred_lft forever\n")),(0,o.kt)("p",null,"If there is not a new network card, you may need to set overlay once again.  "),(0,o.kt)("p",null,"Network Manager Tool is the recommended tool to manage the network, typing the command to open the interface:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"radxa@rock-5a:~$ sudo nmtui\n")),(0,o.kt)("p",null,"After identification, the setting interface appears:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"                              NetworkManager TUI \n                                                   \n                            Please select an option\n                                                   \n                            Edit a connection      \n                            Activate a connection  \n                            Set system hostname    \n                                                   \n                            Quit                   \n                                                   \n                                              <OK> \n")),(0,o.kt)("p",null,"Select ",(0,o.kt)("inlineCode",{parentName:"p"},"Edit a connection -- <Add>")," to add a ",(0,o.kt)("inlineCode",{parentName:"p"},"Ethernet")," adapter:\n",(0,o.kt)("img",{alt:"add adapter",src:n(7628).Z,width:"1140",height:"708"}),(0,o.kt)("br",{parentName:"p"}),"\n","Of the many options, we only need to fill in two of them:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"        Device____  # Enter the third network card name you get by 'ip a', like: enxca5bfb533dd4\n        IPv4 CONFIGURATION <Shared> # Change <Automatic> to <Shared> \n")),(0,o.kt)("p",null,"Save the configuration and return to setting interface to ",(0,o.kt)("inlineCode",{parentName:"p"},"Activate a connectin"),", select the option you just add.",(0,o.kt)("br",{parentName:"p"}),"\n","It would be following if you apply it right:  "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"                USB Ethernet                       \n                    * Ethernet connection 1\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Confirm adapter setting:"),(0,o.kt)("br",{parentName:"p"}),"\n","After you settings, check if there is a IP address of third network card:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"radxa@rock-5a:~$ ip a\n")),(0,o.kt)("p",null,"The expected output result is like following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"3: enxca5bfb533dd4: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether ca:5b:fb:53:3d:d4 brd ff:ff:ff:ff:ff:ff\n    inet 10.42.0.1/24 brd 10.42.0.255 scope global noprefixroute enxca5bfb533dd4\n       valid_lft forever preferred_lft forever\n    inet6 fe80::e37c:5ced:58a8:ec32/64 scope link noprefixroute\n       valid_lft forever preferred_lft forever\n\n")),(0,o.kt)("p",null,"If it's similar with your result, time to set up device machine."),(0,o.kt)("h3",{id:"to-device-machine"},"To Device machine"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Enable usb network connection:"),"\nRelative to Host machine, it woulb be easy for device machine settings.",(0,o.kt)("br",{parentName:"p"}),"\n","At first, enable the ",(0,o.kt)("inlineCode",{parentName:"p"},"Set OTG port to Peripheral mode")," overlay and start the ",(0,o.kt)("inlineCode",{parentName:"p"},"radxa-usbnet")," service, reboot.",(0,o.kt)("br",{parentName:"p"}),"\n","Typing ",(0,o.kt)("inlineCode",{parentName:"p"},"ip a")," to confirm if a new device named ",(0,o.kt)("inlineCode",{parentName:"p"},"usb0")," like the following added: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"3: usb0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc pfifo_fast state DOWN group default qlen 1000\n    link/ether 76:c7:9d:9e:d5:da brd ff:ff:ff:ff:ff:ff\n")),(0,o.kt)("p",null,"If not, check previous steps: reopen the overlay (Don't forget to reboot.) and restart the usbnet service.  "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Set up usbnet adapter:"),"\nNext, set up the adapter as set up the Host device:",(0,o.kt)("br",{parentName:"p"}),"\n","Open the Network Manager Tool: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"radxa@rock-5a:~$ sudo nmtui\n")),(0,o.kt)("p",null,"Select ",(0,o.kt)("inlineCode",{parentName:"p"},"Edit a connection -- <Add>")," to add a ",(0,o.kt)("inlineCode",{parentName:"p"},"Ethernet")," adapter: "),(0,o.kt)("p",null,"Only the Device option should be modify, type 'usb0':"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Device usb0\n")),(0,o.kt)("p",null,"Other options remain default. Save the configuration.  "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Connect to Host device:")),(0,o.kt)("p",null,"Return to setting interface to ",(0,o.kt)("inlineCode",{parentName:"p"},"Activate a connectin"),", select the option you just add."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"                Ethernet (usb0)                       \n                    Ethernet connection 1\n")),(0,o.kt)("p",null,"It would take a few seconds to connect to Host device.  "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Check the connection:")),(0,o.kt)("p",null,"Check if usb0 get the IP address like following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"radxa@rock-5a:~$ ip a\n\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc mq state DOWN group default qlen 1000\n    link/ether f2:44:7d:ac:20:85 brd ff:ff:ff:ff:ff:ff\n3: usb0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether 76:c7:9d:9e:d5:da brd ff:ff:ff:ff:ff:ff\n    inet 10.42.0.46/24 brd 10.42.0.255 scope global dynamic noprefixroute usb0\n       valid_lft 3597sec preferred_lft 3597sec\n    inet6 fe80::1031:1ee2:bcee:4855/64 scope link noprefixroute\n       valid_lft forever preferred_lft forever\n")),(0,o.kt)("p",null,"If the Host machine connect to ethernet, Device machine can also connect now."))}s.isMDXComponent=!0},7628:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/add_adapter-a0358fd563de71328dff99abfaaa9582.png"}}]);